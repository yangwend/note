<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>LODOP DEMO</title>
  <style type="text/css">
    .wrap {
      width: 100vw;
      height: 100vh;
      margin: 0 auto;
    }

    .btn {
      padding: 4px 8px;
      line-height: 30px;
      color: #fff;
      border-color: #009639;
      background: #009639;
      text-shadow: 0 -1px 0 rgb(0 0 0 / 12%);
      box-shadow: 0 2px 0 rgb(0 0 0 / 5%);
      text-align: center;
      border: none;
      margin-top: 20px;
      margin-left: 20px;
      border-radius: 10px;
      cursor: pointer;
    }
  </style>
</head>

<body>
  <form id="form1">
    <table border="1" width="300" id="tb01" bgcolor="#CCFFCC" style="border:solid 1px black;border-collapse:collapse">
      <tbody>
        <tr>
          <td width="133" id="mtb001">
            <font face="黑体" color="#FF0000" size="3"><u>&nbsp;《表单一》&nbsp;</u></font>
          </td>
        </tr>
      </tbody>
    </table>
    <table border="1" width="300" height="106" cellspacing="0" bgcolor="#CCFFFF"
      style="border-collapse:collapse;table-layout:fixed;border:solid 1px black;">
      <tbody>
        <tr>
          <td width="66" height="16" style="border:solid 1px black">
            <font color="#0000FF">A</font>
            <font color="#0000FF">等</font>
          </td>
          <td width="51" height="16" style="border:solid 1px black">
            <font color="#0000FF">B</font>
            <font color="#0000FF">等</font>
          </td>
          <td width="51" height="16" style="border:solid 1px black">
            <font color="#0000FF">C</font>
            <font color="#0000FF">等</font>
          </td>
        </tr>
        <tr>
          <td width="66" height="16" style="border:solid 1px black">A<sub>01</sub></td>
          <td width="80" height="12" style="border:solid 1px black">中-001</td>
          <td width="51" height="12" style="border:solid 1px black">C1<sup>x</sup></td>
        </tr>
        <tr>
          <td width="66" height="16" style="border:solid 1px black">A<sub>02</sub>Φ</td>
          <td width="80" height="16" style="border:solid 1px black">日-スの</td>
          <td width="51" height="16" style="border:solid 1px black">
            <font face="Vernada">7㎥</font>
          </td>
        </tr>
        <tr>
          <td width="66" height="16" style="border:solid 1px black;overflow:hidden">A<sub>03</sub>
            <nobr>over隐藏后面的：1234567890</nobr>
          </td>
          <td width="80" height="16" style="border:solid 1px black;overflow:hidden">韩-안녕</td>
          <td width="51" height="16">C3<sup>x</sup>
          </td>
        </tr>
      </tbody>
    </table>
  </form>
  <div class="wrap">
    <button class="btn" onclick="checkIsInstall()">查看本机是否安装(控件或web打印服务)</button>
    <br />
    <button class="btn" onclick="preview()">打印预览</button>
    <br />
    <button class="btn" onclick="print()">直接打印</button>
    <br />
    <button class="btn" onclick="choosePrint()">选择打印机</button>
    <br />
    <button class="btn" onclick="manage()">打印维护</button>
    <br />
    <button class="btn" onclick="design()">打印设计</button>
    <divider></divider>
    <br />
    <button class="btn" onclick="myPrintSetup1()">背景图打印维护</button>
  </div>
  <script type="text/javascript" src="./LodopFuncs.js"></script>
  <object id="LODOP_OB" classid="clsid:2105C259-1E0C-4534-8141-A753534CB4CA" width=0 height=0>
    <embed id="LODOP_EM" type="application/x-print-lodop" width=0 height=0 pluginspage="install_lodop32.exe"></embed>
  </object>
  <script type="text/javascript">
    var LODOP;
    function checkIsInstall() {
      try {
        var LODOP = getLodop();
        if (LODOP.VERSION) {
          if (LODOP.CVERSION)
            alert("当前有WEB打印服务C-Lodop可用!\n C-Lodop版本:" + LODOP.CVERSION + "(内含Lodop" + LODOP.VERSION + ")");
          else
            alert("本机已成功安装了Lodop控件！\n 版本号:" + LODOP.VERSION);

        }
      } catch (err) {
      }
    }

    function createFormPage() {
      // LODOP = getLodop(document.getElementById('LODOP_OB'), document.getElementById('LODOP_EM'));
      LODOP = getLodop();
      LODOP.PRINT_INIT("打印控件功能演示_Lodop功能");
      LODOP.SET_PRINT_PAGESIZE(1, 0, 0, "A4");
      // LODOP.ADD_PRINT_RECT(10, 10, 500, 800, 0, 4);
      LODOP.ADD_PRINT_TEXT(20, 120, 260, 39, "第一行文本");
      // LODOP.SET_PRINT_STYLE("FontSize", 30);
      // LODOP.SET_PRINT_STYLE("Bold", 1);
      LODOP.ADD_PRINT_TEXT(50, 120, 260, 39, "打印表单一");
      // LODOP.SET_PRINT_STYLEA(1, "FontName", "隶书");
      LODOP.SET_PRINT_STYLEA(0, "FontSize", 40);
      LODOP.ADD_PRINT_TEXT(80, 120, 260, 39, "第三行文本");
      // LODOP.ADD_PRINT_HTM(100, 100, 400, 600, document.getElementById("form1").innerHTML);
      // LODOP.ADD_PRINT_TEXT(250, 100, 75, 20, "科学家");
      // LODOP.ADD_PRINT_TEXT(270, 100, 272, 20, "地址：中国北京社会科学院附近东大街西胡同");
      // LODOP.ADD_PRINT_TEXT(290, 100, 166, 20, "电话：010-88811888");
      // // LODOP.ADD_PRINT_BARCODE(310,100,360,47,"128A","3e3e33e3e33e");
      // LODOP.ADD_PRINT_BARCODE(310,100,161,64,"128C","888888");
      // // LODOP.SET_PRINT_STYLEA(0,"Angle",35);
      // LODOP.ADD_PRINT_BARCODE(451,100,360,36,"EAN128A","123456789012");
      // LODOP.SET_PRINT_STYLEA(0,"ShowBarText", 0);
      // // LODOP.ADD_PRINT_IMAGE(550, 100, 300, 160, "<img border='0' src='http://www.c-lodop.com/demolist/PrintSample9.jpg'>")
      // LODOP.ADD_PRINT_BARCODE(610,100,360,47,"128A","3e3e33e3e33e");
    }

    function preview() {
      createFormPage();
      LODOP.PREVIEW();
    }

    function print() {
      createFormPage();
      LODOP.PRINT();
    }

    function choosePrint() {
      createFormPage();
      LODOP.PRINTA();
    }

    function manage() {
      createFormPage();
      LODOP.PRINT_SETUP();
    }

    function design() {
      createFormPage();
      LODOP.PRINT_DESIGN();
    }

    function CreatePage() {
      // LODOP = getLodop(document.getElementById('LODOP_OB'), document.getElementById('LODOP_EM'));
      LODOP = getLodop();
      LODOP.PRINT_INIT("打印控件功能演示_Lodop功能_装载背景图");
      LODOP.ADD_PRINT_TEXT(83, 78, 75, 20, "寄件人姓名");
      LODOP.ADD_PRINT_TEXT(109, 137, 194, 20, "寄件人单位名称");
      LODOP.ADD_PRINT_TEXT(134, 90, 238, 35, "寄件人的详细地址");
      LODOP.ADD_PRINT_TEXT(85, 391, 75, 20, "收件人姓名");
      LODOP.ADD_PRINT_TEXT(108, 440, 208, 20, "收件人单位名称");
      LODOP.ADD_PRINT_TEXT(137, 403, 244, 35, "收件人详细地址");
      LODOP.ADD_PRINT_TEXT(252, 33, 164, 40, "内件品名");
      LODOP.ADD_PRINT_TEXT(261, 221, 100, 20, "内件数量");
      LODOP.ADD_PRINT_TEXT(83, 212, 100, 20, "寄件人电话");
      LODOP.ADD_PRINT_TEXT(80, 554, 75, 20, "收件人电话");
    }

    function myPrintSetup1() {
      CreatePage();
      LODOP.ADD_PRINT_SETUP_BKIMG("<img border='0' src='http://www.c-lodop.com/demolist/PrintSample9.jpg'>");
      LODOP.SET_SHOW_MODE("BKIMG_LEFT", 1);
      LODOP.SET_SHOW_MODE("BKIMG_TOP", 1);
      LODOP.SET_SHOW_MODE("BKIMG_WIDTH", "183mm");
      //LODOP.SET_SHOW_MODE("BKIMG_HEIGHT","99mm"); //这句可不加，因宽高比例固定按原图的
      LODOP.SET_SHOW_MODE("BKIMG_IN_PREVIEW", "1")
      LODOP.SET_SHOW_MODE("BKIMG_PRINT", 1);//打印包含背景图
      LODOP.PRINT_SETUP();
    }
  </script>
</body>

</html>